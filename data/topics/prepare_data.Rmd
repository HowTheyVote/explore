---
title: "What Parliament Votes On"
output: html_document
---

```{r}
library(textstem)
library(dplyr)
library(purrr)
library(tidytext)
library(stopwords)
library(ggplot2)
```

```{r Load Data}
vc <- read.csv('vote_collections.csv')
```

```{r Tokenize & Lemmatize}
remove_pattern <- '\\b(eu|european union|[0-9]+|i+)\\b'

vc <- vc %>%
  select(title, date) %>%
  mutate(title = tolower(title)) %>%
  mutate(title = gsub(remove_pattern, '', title)) %>%
  mutate(title = lemmatize_strings(title)) %>%
  mutate(month = format(as.Date(date), '%Y-%m'))
```

```{r Common Words}
common_words <- vc %>%
  unnest_tokens(word, title, stopwords=stopwords('en')) %>%
  count(word, sort = TRUE) %>%
  top_n(25)

ggplot(common_words, aes(x = reorder(word, n), y = n)) +
    geom_bar(stat = 'identity') +
    coord_flip()
```

```{r Common Bi-Grams}
common_bigrams <- vc %>%
  unnest_tokens(bigram, title, token = 'ngrams', n = 2, stopwords = stopwords('en')) %>%
  count(bigram, sort = TRUE) %>%
  top_n(25)

ggplot(common_bigrams, aes(x = reorder(bigram, n), y = n)) +
  geom_bar(stat = 'identity') +
  coord_flip()
```

```{r Common Skipgrams}
common_skipbigrams <- vc %>%
  unnest_tokens(skipbigram, title, token = 'skip_ngrams', n = 2, k = 1, stopwords = stopwords('en')) %>%
  count(skipbigram, sort = TRUE) %>%
  top_n(25)

ggplot(common_skipbigrams, aes(x = reorder(skipbigram, n), y = n)) +
  geom_bar(stat = 'identity') +
  coord_flip()
```
